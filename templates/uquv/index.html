{% extends 'uquv/uquv.html' %}
{% block title %} <title>KPI Foydalanuvchi </title> {% endblock %}

{% block blockName %}
<!-- partial -->
<div class="container-fluid page-body-wrapper">
  <div class="main-panel">
    <div class="content-wrapper">


      <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <h4 class="card-title">Umumiy natijalar</h4>
            <p class="card-description">


              <button id="btn-export"><i class="mdi mdi-briefcase-download"></i> Excel formatda</button>
            </p>
            <div class="table-responsive pt-3">
              <table class="table table-bordered" id="my-table">
                <thead>
                  <tr>
                    <th>
                      #
                    </th>
                    <th>
                      Ism Familiyasi
                    </th>
                    <th>
                      Umumiy ballari
                    </th>
                    <th>
                      Natija (100 dan)
                    </th>
                  </tr>
                </thead>
                <tbody>
                  {% for object in get_list %}
                  <tr>
                    <td>
                      {{forloop.counter}}
                    </td>
                    <td>
                      {{object.name}}
                    </td>
                    <td>
                      {{object.ball}} ball
                    </td>
                    <td>
                      <div class="progress">
                        <div class="progress-bar bg-success" role="progressbar" style="width: {{object.ball}}%"
                          aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                    </td>

                  </tr>
                  {% endfor %}


                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
      <script>
        const exportButton = document.getElementById('btn-export');

        const table = document.getElementById('my-table');

        exportButton.addEventListener('click', () => {
          /* Create worksheet from HTML DOM TABLE */
          const wb = XLSX.utils.table_to_book(table, { sheet: 'sheet-1' });

          /* Export to file (start a download) */
          XLSX.writeFile(wb, 'MyTable.xlsx');
        });
      </script>
    </div>
    <!-- content-wrapper ends -->
    <!-- partial:partials/_footer.html -->
    <footer class="footer">
      <div class="footer-wrap">
        <div class="d-sm-flex justify-content-center justify-content-sm-between">
          <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">Yaratgan Â© <a
              href="https://www.bootstrapdash.com/" target="_blank">Qo'chqorov Jurat Jalilovich </a>2023</span>
          <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">KPI Platform<a
              href="https://www.bootstrapdash.com/" target="_blank"> </a> dasturi</span>
        </div>
      </div>
    </footer>
    <!-- partial -->
  </div>
  {% endblock %}